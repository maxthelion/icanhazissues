function updateIssue(e,t,a){{var s=window.location.pathname.split("/")[3],r="/issues/"+s+"/update/"+e,i={oldLabel:t,newLabel:a};$.ajax({url:r,type:"POST",data:i,success:function(e){console.log(e)},error:function(e){console.log("Error: "+JSON.parse(e))}})}}function _getColourCode(e){var e=new Date(e),t=new Date,a=t-e,s=864e5,r=t-t%s-s;return e>r?"#00B16A":7*s>a?"#F7CA18":14*s>a?"#F9690E":"#F22613"}function _assignColourCode(){$(".issue-list-item").each(function(){var e=_getColourCode($(this).attr("data-created"));$(this).css("border-bottom-width","5px").css("border-bottom-color",e)})}var pusher=new Pusher(pusherKey,{authEndpoint:"/pusher/auth"}),channel=pusher.subscribe("private-issues");channel.bind("client-issue-updates",function(e){var t="#"+e.fromLabel+"-"+e.number;$(t).remove();var a="."+e.milestone+"-"+e.toLabel+"-list-group",s="";e.avatarUrl&&(s='<span class="pull-right">                   <img src="'+e.avatarUrl+'" class="img img-circle avatar"></img>                 </span>');var r=e.toLabel+"-"+e.number;if(s)var i='<li class="list-group-item issue-list-item" data-created="'+e.createdAt+'" data-issue-number="'+e.number+'" id="'+r+'">                       <div class="issue-text col-xs-8">                         <a href="'+e.url+'"> '+e.text+'                       </div>                       <div class="issue-assignee col-xs-4 pull-right">                         '+s+"                       </div>                     </li>";else var i='<div class="issue-text col-xs-12">                       <a href="'+e.url+'"> '+e.text+" </a>                     </div>";$(a).append(i),_assignColourCode()});for(var issueGroups=document.getElementsByClassName("issue-list-group"),fromLabel="",toLabel="",fromMilestone="",toMilestone="",i=0;i<issueGroups.length;i++){var issueMilestone=issueGroups[i].getAttribute("data-milestone");Sortable.create(issueGroups[i],{group:"issue-"+issueMilestone,animation:150,dragable:".issue-list-item",ghostClass:"sortable-ghost",onStart:function(e){var t=e.item.parentNode;fromLabel=t.getAttribute("data-label"),fromGroup=t.getAttribute("data-milestone")},onEnd:function(e){var t=e.item.getAttribute("data-issue-number"),a=e.item.parentNode;toLabel=a.getAttribute("data-label"),toGroup=a.getAttribute("data-milestone");var s=e.item.children,r={number:t,milestone:toGroup,fromLabel:fromLabel,toLabel:toLabel,createdAt:e.item.getAttribute("data-created"),url:s[0].href,text:s[0].children[0].innerText};s[1]&&(r.avatarUrl=s[1].children[0].children[0].currentSrc),fromLabel!=toLabel&&fromMilestone==toMilestone&&(e.item.setAttribute("id",toLabel+"-"+t),channel.trigger("client-issue-updates",r),updateIssue(t,fromLabel,toLabel))}})}$(window).load(function(){$(".heading-column:last-child").append('<a class="add-issue-button pull-right" target="_blank" href="'+newIssueUrl+'">       <i class="fa fa-plus fa-sm"></i>     </a>'),_assignColourCode()});